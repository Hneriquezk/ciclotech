<!DOCTYPE html>
<html lang="pt-BR">

<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Pagamento - Ciclotech</title>
  <link rel="stylesheet" href="../css/identificacao.css">
</head>

<body>
    <header>
        <div class="lado-esquerdo">
            <a href="../html/contato.html">CONTATO</a>
            <a href="../html/home.php">HOME</a>
        </div>

        <div class="logo">
            <img src="../img/logo.png" alt="Ciclotech">
        </div>

        <div class="carrinho">
            <img src="../img/carrinho.png" alt="Carrinho">
        </div>
    </header>
    <br>
    <nav>
        <a href="#">Bicicletas/Quadros</a>
        <span>|</span>
        <a href="#">Capacetes</a>
        <span>|</span>
        <a href="#">Rodas</a>
        <span>|</span>
        <a href="#">Pneus/Câmaras</a>
        <span>|</span>
        <a href="#">Óculos</a>
        <span>|</span>
        <a href="#">Luvas</a>
        <span>|</span>
        <a href="#">Vestuário</a>
        <span>|</span>
        <a href="#">Kit Limpeza</a>
    </nav>
    <br><br>
  <!-- ================= CARRINHO LATERAL ================= -->
  <div id="carrinho-lateral" class="carrinho-lateral">
    <div class="carrinho-header">
      <h2>Carrinho</h2>
      <button id="fechar-carrinho">&times;</button>
    </div>
    <div id="carrinho-itens" class="carrinho-itens">
      <p>Seu carrinho está vazio</p>
    </div>
    <div class="carrinho-footer">
      <div class="total">Total: <span id="carrinho-total">R$0,00</span></div>
      <button id="finalizar-compra">Finalizar Compra</button>
    </div>
  </div>
  <main>
    <div class="steps">
      <a class="step current">2 Identificação</a>
      <a href="pagamento.html" class="step">3 Pagamento</a>
    </div>
    <br>
    <div class="card">
      <h2 class="title">Endereço</h2>

      <form class="form-container">
        <input type="text" placeholder="Endereço" required />
        <div class="row">
          <input type="text" placeholder="Número" required />
          <input type="text" placeholder="Complemento" />
          <input type="text" placeholder="Bairro" required />
        </div>
        <div class="row">
          <input type="text" placeholder="CEP" required />
          <input type="text" placeholder="Cidade" required />
          <select required>
            <option value="">Selecione</option>
            <option>AC</option>
            <option>AL</option>
            <option>AP</option>
            <option>AM</option>
            <option>BA</option>
            <option>CE</option>
            <option>DF</option>
            <option>MA</option>
            <option>MG</option>
            <option>MT</option>
            <option>MS</option>
            <option>PA</option>
            <option>PB</option>
            <option>PR</option>
            <option>PE</option>
            <option>PI</option>
            <option>RJ</option>
            <option>RN</option>
            <option>RS</option>
            <option>RO</option>
            <option>RR</option>
            <option>SC</option>
            <option>SP</option>
            <option>SE</option>
            <option>TO</option>
          </select>
        </div>
        <button type="submit">
          <a href="pagamento.html" style="color: white; text-decoration: none;">Cadastrar</a>
        </button>
      </form>

      <div class="payments">
        <img src="../img/1.png" alt="MasterCard" />
        <img src="../img/2.png" alt="Visa" />
        <img src="../img/3.png" alt="Elo" />
        <img src="../img/4.png" alt="Pix" />
        <img src="../img/5.png" alt="Hipercard" />
      </div>
    </div>
  </main>

  <footer>
    <div class="footer-top">
      <span>Entregamos para o Mundo inteiro</span>
      <span>Desconto no pix: 10%</span>
      <span>SITE 100% SEGURO</span>
    </div>
    <div class="footer-main">
      <div class="footer-logo">
        <img src="../img/logo.png" alt="Ciclotech">
        <p>A loja mais especializada em itens de ciclismo geral no Brasil.</p>
      </div>
      <div class="footer-section">
        <h3>Informações</h3>
        <ul>
          <li><a href="index.html">Cilcotech</a></li>
          <li><a href="#">Política De Privacidade</a></li>
          <li><a href="#">Trocas e Devoluções</a></li>
        </ul>
      </div>
      <div class="footer-section footer-contact">
        <h3>Atendimento</h3>
        <p>Segunda a Sexta<br>10:00 ás 16:00</p>
        <br>
        <h3>Contato</h3>
        <p>(12)1234-5678</p>
        <p>(12)1234-5678</p>
        <h3>Redes Sociais</h3>
        <div class="footer-social">
          <img src="../img/instagram.png" alt="Instagram">
          <img src="../img/facebook.png" alt="Facebook">
        </div>
      </div>
      <div class="footer-section footer-payment">
        <h3>Formas de Pagamento</h3>
        <div>
          <img src="../img/visa.jpg" alt="Visa">
          <img src="../img/mastercard.png" alt="Mastercard">
          <img src="../img/hipercard.png" alt="Hipercard">
          <img src="../img/elo.png" alt="Elo">
          <img src="../img/boleto.png" alt="Boleto">
          <img src="../img/pix.png" alt="Pix">
          <img src="../img/paypal.png" alt="Paypal">
        </div>
      </div>
    </div>
  </footer>
  <script>
    // ======================= CARRINHO LATERAL =======================
const carrinho = document.getElementById("carrinho-lateral");
const fecharCarrinho = document.getElementById("fechar-carrinho");
const carrinhoItens = document.getElementById("carrinho-itens");
const carrinhoTotal = document.getElementById("carrinho-total");

document.querySelector(".carrinho img").addEventListener("click", () => {
    carrinho.classList.add("ativo");
        renderCarrinho();
    });
fecharCarrinho.addEventListener("click", () => carrinho.classList.remove("ativo"));

    function getCarrinho() {
         return JSON.parse(localStorage.getItem("carrinho")) || [];
    }
    function salvarCarrinho(itens) {
        localStorage.setItem("carrinho", JSON.stringify(itens));
    }

 // Renderiza os itens no carrinho
    function renderCarrinho() {
        const itens = getCarrinho();
        carrinhoItens.innerHTML = "";

         if (itens.length === 0) {
            carrinhoItens.innerHTML = "<p>Seu carrinho está vazio</p>";
            carrinhoTotal.innerText = "R$0,00";
            return;
        }

    let total = 0;
        itens.forEach((item, index) => {
            total += item.preco * item.quantidade;
            const div = document.createElement("div");
            div.classList.add("item-carrinho");
            div.innerHTML = `
         <img src="${item.img}" alt="${item.nome}">
         <div class="item-info">
            <h4>${item.nome}</h4>
            <p>R$${item.preco.toFixed(2)}</p>
            <div class="quantidade">
                <button onclick="alterarQtd(${index}, -1)">-</button>
                <span>${item.quantidade}</span>
                <button onclick="alterarQtd(${index}, 1)">+</button>
                </div>
                <span class="remover" onclick="removerItem(${index})">Remover</span>
            </div>
        `;
                carrinhoItens.appendChild(div);
            });

            carrinhoTotal.innerText = `R$${total.toFixed(2)}`;
        }

        function alterarQtd(index, delta) {
            let itens = getCarrinho();
            itens[index].quantidade += delta;
            if (itens[index].quantidade <= 0) itens.splice(index, 1);
            salvarCarrinho(itens);
            renderCarrinho();
        }

        function removerItem(index) {
            let itens = getCarrinho();
            itens.splice(index, 1);
            salvarCarrinho(itens);
            renderCarrinho();
        }

        document.getElementById("finalizar-compra").addEventListener("click", () => {
            // Verifica se há itens no carrinho antes de redirecionar
            const itens = getCarrinho();
            if (itens.length === 0) {
            alert("Seu carrinho está vazio!");
            return;
        }

        // Salva o total no localStorage para usar na página de pagamento
        const total = itens.reduce((acc, item) => acc + item.preco * item.quantidade, 0);
        localStorage.setItem("totalCompra", total.toFixed(2));

        // Redireciona para a página de pagamento
        window.location.href = "../html/identificacao.html";
});

        renderCarrinho();

    // ======================= EVENTOS =======================
    carrinhoIcon.addEventListener("click", abrirCarrinho);
    fecharCarrinhoBtn.addEventListener("click", fecharCarrinho);
    finalizarCompraBtn.addEventListener("click", finalizarCompra);

    if (stepCarrinho) {
      // Clicar no stepCarrinho apenas abre o carrinho, não muda de página
      stepCarrinho.addEventListener("click", (e) => {
        e.preventDefault();
        abrirCarrinho();
      });
    }

    // Renderiza o carrinho ao carregar a página
    renderCarrinho();
  </script>
</body>

</html>